import pickle
import pandas as pd
import numpy as np

def load_model():
    with open("../models/model.pkl", "rb") as f:
        model = pickle.load(f)
    with open("../models/label_encoder.pkl", "rb") as f:
        le = pickle.load(f)
    return model, le

def predict(input_data):
    model, le = load_model()
    features = np.array(input_data).reshape(1, -1)
    pred = model.predict(features)
    species = le.inverse_transform(pred)
    return species[0]

if __name__ == "__main__":
    # Example usage
    sample = [5.1, 3.5, 1.4, 0.2]
    print("Predicted species:", predict(sample))
